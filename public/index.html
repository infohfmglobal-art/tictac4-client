<script>
  const socket = io();
  const board = document.getElementById('board');
  const statusText = document.getElementById('status');
  const clickSound = document.getElementById('clickSound');

  let myTurn = false;
  let symbol = null;
  const cells = [];

  // Create 3x3 board
  for (let i = 0; i < 9; i++) {
    const cell = document.createElement('div');
    cell.className = 'cell';
    cell.dataset.index = i;

    cell.addEventListener('click', () => {
      // Unlock sound after first interaction
      if (clickSound.paused) {
        clickSound.play().catch(() => {});
        clickSound.pause();
        clickSound.currentTime = 0;
      }

      if (myTurn && !cell.textContent) {
        cell.textContent = symbol;
        clickSound.play();
        socket.emit('move', { index: i, symbol });
        myTurn = false;
        statusText.textContent = "Opponent's turn...";
      }
    });

    board.appendChild(cell);
    cells.push(cell);
  }

  // Assign symbol randomly for now (temporary)
  socket.on('connect', () => {
    symbol = Math.random() > 0.5 ? 'X' : 'O';
    myTurn = symbol === 'X';
    statusText.textContent = myTurn ? "Your turn (X)" : "Opponent's turn (O)";
  });

  // Receive opponent moves
  socket.on('move', (data) => {
    const { index, symbol: opponentSymbol } = data;
    cells[index].textContent = opponentSymbol;
    clickSound.play();
    myTurn = true;
    statusText.textContent = "Your turn...";
  });
</script>
